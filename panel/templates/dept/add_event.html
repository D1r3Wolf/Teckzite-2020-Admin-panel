{% extends "base.html" %}

{% block content %}
{{ super() }}

<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h1 class="modal-title">Alert</h1>
      </div>
      <div class="modal-body" id="alert-body">
        <p>This may <b>take a few seconds</b>. (Need to send credential mail to user)</p>
        <p><b style="color: red;">Please wait. Dont close or Refresh the page</b></p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal" id="SendDetails">OK</button>
        <button type="button" class="btn btn-default" data-dismiss="modal">cancel</button>
      </div>
    </div>

  </div>
</div>


	<div class="container">
		<div class="row">
			<div class="col-sm-4 ">
				<h3>Add Event</h3>
				<br>
				<form action="" method="post" id="submitForm">
					<dl>
						{{ render_field(form.Ename) }}
						{{ render_field(form.StuID) }}
						{{ render_field(form.StuName) }}
						{{ render_field(form.Email) }}
						{{ render_field(form.Phone) }}

						{{ form.csrf_token }}
					</dl>
					<button type="button" class="form-control btn btn-default" data-toggle="modal" data-target="#myModal" id="popup">Submit</button>
					
					{{ form.post(class="form-control btn btn-default", style="display: none;", id="submit-button") }}
				</form>
			</div>
		</div>
	</div>
{% endblock %}

{% block html %}
	{{ super() }}
	<script type="text/javascript">
		$('#Ename').keypress(function(e){
		    if ( e.which == 13 ) e.preventDefault();
		    if ( e.which == 13 ) return false;
		});
		$('#StuID').keypress(function(e){
		    if ( e.which == 13 ) e.preventDefault();
		    if ( e.which == 13 ) return false;
		});
		$('#StuName').keypress(function(e){
		    if ( e.which == 13 ) e.preventDefault();
		    if ( e.which == 13 ) return false;
		});
		$('#Email').keypress(function(e){
		    if ( e.which == 13 ) e.preventDefault();
		    if ( e.which == 13 ) return false;
		});
		$('#Phone').keypress(function(e){
		    if ( e.which == 13 ) e.preventDefault();
		    if ( e.which == 13 ) return false;
		});
		$("#SendDetails").click(function () {
			$("#alert-body").empty();
			$("#alert-body").append('<center><i class="fa fa-gear fa-spin" style="font-size: 200px;"></i><br><h3>Loading! Please wait</h3></center>')
			$('button').prop('disabled', true);
			$('body').css('opacity', 0.5);
			document.forms[0].submit();

		})
	</script>
{% endblock %}